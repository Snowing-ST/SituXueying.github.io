I"¿Ï<p>å¯¹æ‹›è˜ä¿¡æ¯ä¸­æè¿°çš„ä¸“ä¸šæŠ€èƒ½è¿›è¡Œé‡åŒ–ï¼Œä»è€Œæ¢ç©¶ä¸“ä¸šæŠ€èƒ½å¯¹è–ªèµ„çš„å½±å“ã€‚</p>

<h1 id="åŸºäºæ–‡æœ¬èšç±»çš„æ‹›è˜ä¿¡æ¯ä¸­æŠ€èƒ½è¦æ±‚æå–ä¸é‡åŒ–">ã€ŠåŸºäºæ–‡æœ¬èšç±»çš„æ‹›è˜ä¿¡æ¯ä¸­æŠ€èƒ½è¦æ±‚æå–ä¸é‡åŒ–ã€‹</h1>

<ul>
  <li>ä¸Šç¯‡ <a href="Extracting-Skill-Imformation-from-recruitment-ADs-with-text-clustering-1.html">å®ä¹ åƒ§çˆ¬è™«ä¸æ‹›è˜ä¿¡æ¯æ–‡æœ¬é¢„å¤„ç†</a></li>
  <li>ä¸­ç¯‡ <a href="Extracting-Skill-Imformation-from-recruitment-ADs-with-text-clustering-2.html">æ‹›è˜ä¿¡æ¯æ–‡æœ¬èšç±»</a></li>
  <li>
    <font color="pink">ä¸‹ç¯‡ é‡åŒ–è–ªèµ„ä¸æŠ€èƒ½çš„å…³ç³» </font>
  </li>
</ul>

<h2 id="ldaä¸»é¢˜æ¨¡å‹é‡åŒ–æŠ€èƒ½è¦æ±‚">LDAä¸»é¢˜æ¨¡å‹é‡åŒ–æŠ€èƒ½è¦æ±‚</h2>
<h4 id="1-ä¸“ä¸šæŠ€èƒ½å…³é”®è¯ä¸è–ªèµ„çš„å…³ç³»">1. ä¸“ä¸šæŠ€èƒ½å…³é”®è¯ä¸è–ªèµ„çš„å…³ç³»</h4>
<p>ä»èŒä½æè¿°çš„æ–‡æœ¬ä¸­æå–ä¸“ä¸šæŠ€èƒ½å…³é”®è¯ï¼Œé€‰å‡ºéœ€æ±‚é¢‘ç‡æœ€é«˜çš„å‰10ä¸ªæŠ€èƒ½ï¼ŒæŒ‘é€‰å‡ºåŒ…å«è¿™äº›æŠ€èƒ½çš„æ‹›è˜ä¿¡æ¯ï¼Œæ ¹æ®åŒ…å«æŸä¸€ä¸ªæŠ€èƒ½çš„æ‰€æœ‰æ‹›è˜ä¿¡æ¯çš„å·¥èµ„è®¡ç®—å‡ºè¯¥æŠ€èƒ½å¯¹åº”çš„å¹³å‡å·¥èµ„ï¼Œå¦‚å›¾3æ‰€ç¤ºï¼Œæ¨ªè½´ä¸ºæŠ€èƒ½å…³é”®è¯ï¼Œçºµè½´ä¸ºå¹³å‡å·¥èµ„ï¼Œç‚¹çš„å¤§å°ä»£è¡¨è¯¥æŠ€èƒ½éœ€æ±‚é‡çš„å¤šå°‘ã€‚</p>

<p>åœ¨å‰10é¡¹æŠ€èƒ½ä¸­ï¼Œexceléœ€æ±‚æœ€å¤§ï¼Œä½†å¹³å‡è–ªèµ„æœ€ä½ï¼Œä»…ä¸º144å…ƒï¼Œå› ä¸ºexcelæ˜¯æ•°æ®åˆ†æå·¥ä½œæœ€åº”è¯¥æŒæ¡çš„å·¥å…·ï¼›Hadoopï¼Œ Sparkè¿™ä¸¤è€…éœ€æ±‚å°‘ï¼Œä½†å¹³å‡è–ªé…¬æ°´å¹³æœ€é«˜ï¼Œè¶…è¿‡200å…ƒï¼Œå¹¶ä¸”ç›¸å¯¹å…¶ä»–æŠ€èƒ½æ¥è¯´æœ‰æ¯”è¾ƒå¤§çš„å·®å¼‚ï¼Œå› ä¸ºHadoopï¼Œ Sparkéƒ½æ˜¯åº”ç”¨äºåˆ†å¸ƒå¼æ•°æ®å¤„ç†ï¼›å…¶ä»–è½¯ä»¶å¯¹åº”å¾—å¹³å‡è–ªèµ„åœ¨160-200ä¹‹é—´ã€‚å› æ­¤ä¸“ä¸šæŠ€èƒ½å¯¹è–ªèµ„æœ‰æ˜æ˜¾å½±å“ã€‚</p>

<p><img src="/assets/images/post_images/skill-salary.png" /></p>

<h4 id="2-ldaé‡åŒ–æŠ€èƒ½è¦æ±‚">2. LDAé‡åŒ–æŠ€èƒ½è¦æ±‚</h4>
<p>é€šè¿‡LDAçš„æå–10ä¸ªä¸»é¢˜çš„å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸“ä¸šæŠ€èƒ½æè¿°ä¹Ÿæœ‰é«˜ä½ä¹‹åˆ†ï¼Œä»å‰é¢çš„åˆ†æä¹Ÿå¯çœ‹å‡ºï¼Œè¦æ±‚åº”è˜è€…æŒæ¡hadoopã€sparkç­‰å¤§æ•°æ®åˆ†æç›¸å…³æŠ€èƒ½çš„å®ä¹ å·¥èµ„æ›´é«˜äº›ï¼Œä½†ä»…é€šè¿‡ä»æ–‡æœ¬ä¸­æå–æŠ€èƒ½å…³é”®è¯æ¥è¡¡é‡æŠ€èƒ½ä¸è–ªèµ„çš„å…³ç³»ï¼Œä¸€æ¥éœ€è¦é¢„å…ˆçŸ¥é“æœ‰å“ªäº›é‡è¦æŠ€èƒ½ï¼ŒäºŒæ¥æå–çš„æŠ€èƒ½å¤ªå¤šä¼šä½¿å¾—æŠ€èƒ½å› ç´ åˆ†æ•£åœ¨æ¯ä¸ªæŠ€èƒ½å˜é‡ä¸Šï¼Œæ¯ä¸ªæŠ€èƒ½å˜é‡åŒ…å«çš„ä¿¡æ¯è¾ƒå°‘ï¼Œä½¿å¾—è¿™ç§æ–¹æ³•æ›´ä¸ºç¹çï¼Œç¼ºä¹æ™®é€‚æ€§ï¼Œä¸”ä¸åˆ©äºåˆ†ææŠ€èƒ½ä¸è–ªèµ„çš„å…³ç³»ã€‚</p>

<p>å› æ­¤å¯ä»¥å°†æ¯æ¡æ ·æœ¬çš„èŒä½æè¿°ä¸­ä¸“ä¸šæŠ€èƒ½æè¿°çš„å¥å­æŒ‘å‡ºæ¥å†æå–ç»†åˆ†çš„æŠ€èƒ½ä¸»é¢˜ï¼Œæ ¹æ®å¥å­æ‰€å€¾å‘æŠ€èƒ½ä¸»é¢˜çš„é«˜ä½ä¸ºå¥å­æ‰€è¿°çš„æŠ€èƒ½è¦æ±‚è¿›è¡Œè¯„åˆ†ï¼Œè¿™æ ·æ— éœ€ä¸€ä¸ªä¸ªæå–æŠ€èƒ½å…³é”®è¯ï¼Œä¸”æŠŠå¥å­ä¸­çš„å…³é”®è¯ç»¼åˆè€ƒé‡ã€‚å› æ­¤å°†æå–äº†6ä¸ªä¸»é¢˜çš„LDAæ¨¡å‹çš„ç¬¬4ä¸ªä¸»é¢˜ï¼ˆæŠ€èƒ½ä¸»é¢˜ï¼‰å–å€¼å¤§äº0.5çš„å¥å­å–å‡ºæ¥ï¼Œæ„æˆå°å‹ä¸“ä¸šæŠ€èƒ½æè¿°å¥å­è¯­æ–™åº“ï¼Œä¸€å…±268å¥ï¼Œ587ä¸ªè¯ï¼Œå¯¹è¯¥è¯­æ–™åº“å†æ¬¡å»ºç«‹LDAä¸»é¢˜æ¨¡å‹ï¼Œæ•ˆæœå¦‚å›¾4æ‰€ç¤ºï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#æŠŠæ–‡æœ¬ä¸­çš„æŠ€èƒ½è¦æ±‚æå–å‡ºæ¥ï¼Œç„¶åå†å¯¹æŠ€èƒ½ç±»æ–‡æœ¬èšç±»ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½èšå‡ºé«˜ç«¯æŠ€èƒ½ã€ä½ç«¯æŠ€èƒ½
</span>
<span class="n">lda_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span><span class="n">num_topics</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">bow_vector</span> <span class="o">=</span> <span class="n">dictionary</span><span class="o">.</span><span class="n">doc2bow</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="n">bow_vector</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">lda_score</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span>
<span class="n">lda_score</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:]</span>
<span class="n">classify</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lda_score</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"lda"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_topics</span><span class="p">)])</span>
<span class="n">classify</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>




<span class="n">classify</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"clean_text_with_index.csv"</span><span class="p">,</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">"utf-8-sig"</span><span class="p">)</span>
<span class="n">classify</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">classify</span><span class="p">[</span><span class="s">"skill"</span><span class="p">][</span><span class="n">classify</span><span class="p">[</span><span class="s">"lda8"</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>


<span class="c1">#classify.to_csv("text_labels.csv",index = False,encoding = "gbk")
# æ‰‹åŠ¨æŠŠæœ‰å…³å¤§æ•°æ®ã€sparkã€hadoopã€hiveçš„æ ·æœ¬é€‰ä¸Š
</span>

<span class="k">def</span> <span class="nf">skill_text_combine</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="s">"""
    ç›¸åŒindexçš„æ–‡æœ¬åˆå¹¶
    """</span>
   
    <span class="n">index_list</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"index"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">skill_text</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">"index"</span><span class="p">:</span><span class="n">index_list</span><span class="p">,</span><span class="s">"skill_text"</span><span class="p">:[</span><span class="s">""</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">index_list</span><span class="p">)})</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">:</span>
        <span class="n">skill_text</span><span class="p">[</span><span class="s">"skill_text"</span><span class="p">][</span><span class="n">skill_text</span><span class="p">[</span><span class="s">"index"</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s">" "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"text"</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s">"index"</span><span class="p">]</span><span class="o">==</span><span class="n">i</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">skill_text</span>

<span class="n">classify</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"text_labels.csv"</span><span class="p">,</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">"gbk"</span><span class="p">)</span>
<span class="n">skill_text</span> <span class="o">=</span> <span class="n">skill_text_combine</span><span class="p">(</span><span class="n">classify</span><span class="p">[</span><span class="n">classify</span><span class="p">[</span><span class="s">"skill"</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">])</span>
<span class="n">skill_text</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"skill_text.csv"</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">"gbk"</span><span class="p">)</span>

<span class="c1">#ä¸€ç±»åªå‡ºç°äº†msoffice
#ä¸€ç±»è¿˜å‡ºç°äº†sas spss python
#ä¸€ç±»æ˜¯å¤§æ•°æ®çš„è½¯ä»¶ç›¸å…³
</span>

<span class="c1">#é‡æ–°ç´¢å¼•ï¼Œä¸å»é‡ä¸”é‡æ–°ç´¢å¼•åçš„dataåˆå¹¶ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½å¯¹åº”å¾—ä¸Šï¼Œå¦‚æœæœ‰çš„èŒä½æè¿°æ²¡æœ‰ä¸“ä¸šæŠ€èƒ½å¥å­ï¼Œèµ‹å€¼0ï¼Œæœ‰çš„è¯ï¼Œæ ¹æ®ä¸‰ç§èšç±»æ–¹å¼è¿›è¡Œæ‰“åˆ†123å–å¹³å‡
</span><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
<span class="c1">#é‡æ–°ç´¢å¼•
</span><span class="n">data</span><span class="p">[</span><span class="s">"index"</span><span class="p">]</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

<span class="n">data_with_skill</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">skill_text</span><span class="p">,</span><span class="n">how</span> <span class="o">=</span> <span class="s">"outer"</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s">"index"</span><span class="p">)</span>
<span class="n">data_with_skill</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">data_with_skill</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_with_skill</span><span class="p">[</span><span class="s">"score"</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data_with_skill</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"data_with_skill.csv"</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">"gbk"</span><span class="p">)</span>

</code></pre></div></div>

<p><img src="/assets/images/post_images/LDA-3-topics.png" /></p>

<p>å½“LDAæå–3ä¸ªä¸»é¢˜æ—¶ï¼Œæ¯ä¸ªä¸»é¢˜çš„å…³é”®è¯æ­£å¥½èƒ½è¡¨è¾¾æŠ€èƒ½ä¸»é¢˜çš„é«˜ä½ã€‚ç¬¬2ä¸ªä¸»é¢˜çš„å¥å­ä»…è¦æ±‚åº”è˜è€…æŒæ¡msofficeè½¯ä»¶å’ŒSQLæŸ¥è¯¢è¯­è¨€ï¼Œç¬¬1ä¸ªä¸»é¢˜é™¤äº†è¦æ±‚æŒæ¡msofficeå’ŒSQLæŸ¥è¯¢è¯­è¨€ä»¥å¤–ï¼Œè¿˜è¦æ±‚æŒæ¡å…¶ä»–ç»Ÿè®¡åˆ†æè½¯ä»¶ï¼Œå¦‚sasã€spssã€pythonç­‰ï¼Œè€Œç¬¬3ä¸ªä¸»é¢˜åˆ™è¿˜è¦æ±‚åº”è˜è€…ä¼šåº”ç”¨ä¸å¤§æ•°æ®ã€åˆ†å¸ƒå¼æœ‰å…³çš„è½¯ä»¶ï¼Œå¦‚hiveã€hadoopã€sparkã€Javaç­‰ã€‚</p>

<p>æŒ‰æŠ€èƒ½é«˜ä½ç»™æŠ€èƒ½ä¸»é¢˜æ‰“åˆ†1åˆ†ã€2åˆ†ã€3åˆ†ï¼Œè¯¥èŒä½çš„æŠ€èƒ½è¦æ±‚åˆ†æ•°ä¸ºå…¶åœ¨ä¸‰ä¸ªä¸»é¢˜ä¸Šçš„æ¦‚ç‡ä¹˜ä»¥ä¸‰ä¸ªä¸»é¢˜çš„åˆ†å€¼å†æ±‚å’Œï¼Œä»è€Œé‡åŒ–èŒä½çš„æŠ€èƒ½è¦æ±‚ã€‚</p>

<p>å›¾5æ•£ç‚¹å›¾æ˜¾ç¤ºäº†æŠ€èƒ½åˆ†æ•°ä¸å¹³å‡å·¥èµ„çš„å…³ç³»ï¼Œå¯ä»¥çœ‹å‡ºå¤§éƒ¨åˆ†å®ä¹ å·¥èµ„é›†ä¸­åœ¨100-200ä¹‹é—´ï¼Œè€Œå½“æŠ€èƒ½åˆ†æ•°è¶…è¿‡2.5æ—¶ï¼Œæœ‰ä¸€äº›å®ä¹ çš„å·¥èµ„èƒ½è¶…è¿‡300ï¼Œä»loessæ‹Ÿåˆçš„å›å½’æ›²çº¿å¯ä»¥çœ‹å‡ºè½»å¾®æ¸å‡çš„è¶‹åŠ¿ï¼Œè¯´æ˜æŠ€èƒ½è¦æ±‚è¶Šé«˜ï¼Œå…¬å¸æ„¿æ„æ”¯ä»˜çš„å·¥èµ„è¶Šå¤šã€‚</p>

<p><img src="/assets/images/post_images/scartter-plot.png" /></p>

<h2 id="æŠ€èƒ½ä¸è–ªèµ„çš„å›å½’åˆ†æ">æŠ€èƒ½ä¸è–ªèµ„çš„å›å½’åˆ†æ</h2>
<p>å®ä¹ å·¥èµ„çš„é«˜ä½è¿˜è·Ÿå¾ˆå¤šå› ç´ æœ‰å…³ï¼Œå¦‚åœ°åŸŸã€è¡Œä¸šç­‰ï¼Œå› æ­¤æ¥ä¸‹æ¥æŠŠè¿™äº›å› ç´ è€ƒè™‘è¿›å»ï¼Œä»¥å®ä¹ å·¥èµ„ä¸ºå› å˜é‡è¿›è¡Œå›å½’åˆ†æï¼Œé‡ç‚¹è§‚å¯ŸæŠ€èƒ½åˆ†æ•°å¯¹å®ä¹ å·¥èµ„çš„å½±å“ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1">#os.chdir("E:/graduate/class/EDA/final")
</span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">"/Users/situ/Documents/EDA/final"</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"data_with_skill.csv"</span><span class="p">,</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">"gbk"</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">"jobname"</span><span class="p">,</span><span class="s">"jobgood"</span><span class="p">,</span><span class="s">"url"</span><span class="p">,</span><span class="s">"city"</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="c1">#æ•°å€¼å‹æ•°æ®å¤„ç†----------------------
#æ¯å‘¨å·¥ä½œå¤©æ•°
</span><span class="n">data</span><span class="o">.</span><span class="n">jobway</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span>
    <span class="n">mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">'å¤©ï¼å‘¨'</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="k">print</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s">'day_per_week'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'jobway'</span><span class="p">]</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s">'day_per_week'</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>


<span class="c1">#å…¬å¸è§„æ¨¡
</span><span class="n">data</span><span class="p">[</span><span class="s">"size"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s">"comp_size"</span><span class="p">]</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">data</span><span class="p">[</span><span class="s">"comp_size"</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="s">'size'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'å°‘äº15äºº'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'å°å‹ä¼ä¸š'</span>
<span class="n">data</span><span class="p">[</span><span class="s">"comp_size"</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="s">'size'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'15-50äºº'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'å°å‹ä¼ä¸š'</span>
<span class="n">data</span><span class="p">[</span><span class="s">"comp_size"</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="s">'size'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'50-150äºº'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'ä¸­å‹ä¼ä¸š'</span>
<span class="n">data</span><span class="p">[</span><span class="s">"comp_size"</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="s">'size'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'150-500äºº'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'ä¸­å‹ä¼ä¸š'</span>
<span class="n">data</span><span class="p">[</span><span class="s">"comp_size"</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="s">'size'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'500-2000äºº'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'å¤§å‹ä¼ä¸š'</span>
<span class="n">data</span><span class="p">[</span><span class="s">"comp_size"</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="s">'size'</span><span class="p">]</span> <span class="o">==</span> <span class="s">'2000äººä»¥ä¸Š'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'å¤§å‹ä¼ä¸š'</span>

<span class="c1">#å®ä¹ æœˆæ•°
</span><span class="n">data</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">22</span><span class="p">):</span>
    <span class="n">mapping</span><span class="p">[</span><span class="s">"å®ä¹ "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s">'ä¸ªæœˆ'</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
<span class="k">print</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s">'time_span'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'month'</span><span class="p">]</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s">'time_span'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">f</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>

<span class="c1">#æ¯å¤©å·¥èµ„
</span><span class="k">def</span> <span class="nf">get_mean_salary</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[:(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">"-"</span><span class="p">)])</span>
<span class="n">data</span><span class="p">[</span><span class="s">'average_wage'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">'salary'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span><span class="n">get_mean_salary</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="n">data</span><span class="p">[</span><span class="s">'average_wage'</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'jobway'</span><span class="p">,</span><span class="s">'size'</span><span class="p">,</span><span class="s">'month'</span><span class="p">,</span><span class="s">'salary'</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1">#å­—ç¬¦å‹æ•°æ®å¤„ç†--------------------------------
#ï¼ˆåŸå¸‚ï¼‰å¤„ç†
#åŒ—äº¬ã€ä¸Šæµ·ã€æ­å·ã€æ·±åœ³ã€å¹¿å·
</span>
<span class="k">def</span> <span class="nf">get_less_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">useful_classes</span><span class="p">,</span><span class="n">prefix</span><span class="p">):</span>
    <span class="n">useful_classes_prefix</span> <span class="o">=</span> <span class="p">[</span><span class="n">prefix</span><span class="o">+</span><span class="s">"_"</span><span class="o">+</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">useful_classes</span><span class="p">]</span>
    <span class="n">dum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">)</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span><span class="n">useful_classes_prefix</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">dum</span><span class="o">.</span><span class="n">isnull</span><span class="p">()))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">dum</span> <span class="o">=</span> <span class="n">dum</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">search_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">dum</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">useful_classes</span><span class="p">)):</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">useful_classes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">search_index</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">feature</span><span class="p">]))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">dum</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">useful_classes_prefix</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1">#    print(dum.head())
</span>    
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">,</span><span class="n">dum</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="n">feature</span> <span class="o">=</span> <span class="s">"address"</span>
<span class="n">useful_classes</span> <span class="o">=</span> <span class="p">[</span><span class="s">"åŒ—äº¬"</span><span class="p">,</span><span class="s">"ä¸Šæµ·"</span><span class="p">,</span><span class="s">"æ­å·"</span><span class="p">,</span><span class="s">"æ·±åœ³"</span><span class="p">,</span><span class="s">"å¹¿å·"</span><span class="p">,</span><span class="s">"æˆéƒ½"</span><span class="p">,</span><span class="s">"æ­¦æ±‰"</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">get_less_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">useful_classes</span><span class="p">,</span><span class="n">prefix</span><span class="o">=</span><span class="s">"city"</span><span class="p">)</span>

<span class="c1">#è¡Œä¸š
#äº’è”ç½‘ï¼Œè®¡ç®—æœºï¼Œé‡‘èï¼Œç”µå­å•†åŠ¡å’Œä¼ä¸šæœåŠ¡
</span> 


<span class="n">feature</span> <span class="o">=</span> <span class="s">"industry"</span>
<span class="n">useful_classes</span> <span class="o">=</span> <span class="p">[</span><span class="s">"äº’è”ç½‘"</span><span class="p">,</span><span class="s">"è®¡ç®—æœº"</span><span class="p">,</span><span class="s">"é‡‘è"</span><span class="p">,</span><span class="s">"ç”µå­å•†åŠ¡"</span><span class="p">,</span><span class="s">"ä¼ä¸šæœåŠ¡"</span><span class="p">,</span><span class="s">"å¹¿å‘Š"</span><span class="p">,</span><span class="s">"æ–‡åŒ–ä¼ åª’"</span><span class="p">,</span><span class="s">"ç”µå­"</span><span class="p">,</span><span class="s">"é€šä¿¡"</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">get_less_dummies</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">useful_classes</span><span class="p">,</span><span class="s">"industry"</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>


<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'address'</span><span class="p">,</span><span class="s">'industry'</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="c1">#ä¸“ä¸šè¦æ±‚
</span><span class="k">def</span> <span class="nf">get_imp_info</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">useful_classes</span><span class="p">,</span><span class="n">prefix</span><span class="p">):</span>
    <span class="s">"""ç›´æ¥ä»æ–‡æœ¬ä¸­æå–"""</span>
    <span class="n">useful_classes_prefix</span> <span class="o">=</span> <span class="p">[</span><span class="n">prefix</span><span class="o">+</span><span class="s">"_"</span><span class="o">+</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">useful_classes</span><span class="p">]</span>
    <span class="n">dum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">useful_classes</span><span class="p">))),</span><span class="n">columns</span> <span class="o">=</span> <span class="n">useful_classes_prefix</span><span class="p">)</span>
    <span class="n">dum</span> <span class="o">=</span> <span class="n">dum</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">useful_classes</span><span class="p">)):</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">useful_classes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="c1">#        print(token)
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
<span class="c1">#            print(i)
</span>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()))</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">dum</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">useful_classes_prefix</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dum</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    
<span class="c1">#    data = pd.concat([data,dum],axis = 1)
</span>    <span class="k">return</span> <span class="n">dum</span>


<span class="n">feature</span> <span class="o">=</span> <span class="s">"contents"</span>
<span class="n">useful_classes</span> <span class="o">=</span> <span class="p">[</span><span class="s">"ç»Ÿè®¡"</span><span class="p">,</span><span class="s">"è®¡ç®—æœº"</span><span class="p">,</span><span class="s">"æ•°å­¦"</span><span class="p">]</span>
<span class="n">dum</span> <span class="o">=</span> <span class="n">get_imp_info</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">useful_classes</span><span class="p">,</span><span class="s">"subject"</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">,</span><span class="n">dum</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1">#æŠ€èƒ½è¦æ±‚
</span><span class="k">def</span> <span class="nf">get_imp_info2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">useful_classes</span><span class="p">,</span><span class="n">prefix</span><span class="p">):</span>
    <span class="s">"""ä»åˆ†è¯ä¸­æå–"""</span>
    <span class="n">useful_classes_prefix</span> <span class="o">=</span> <span class="p">[</span><span class="n">prefix</span><span class="o">+</span><span class="s">"_"</span><span class="o">+</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">useful_classes</span><span class="p">]</span>
    <span class="n">dum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">useful_classes</span><span class="p">))),</span><span class="n">columns</span> <span class="o">=</span> <span class="n">useful_classes_prefix</span><span class="p">)</span>
    <span class="n">dum</span> <span class="o">=</span> <span class="n">dum</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">useful_classes</span><span class="p">)):</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">useful_classes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="c1">#        print(token)
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
            <span class="n">word_list</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">word_list</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">feature</span><span class="p">])</span>
                <span class="n">dum</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">useful_classes_prefix</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dum</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
    
<span class="c1">#    data = pd.concat([data,dum],axis = 1)
</span>    <span class="k">return</span> <span class="n">dum</span>


<span class="n">feature</span> <span class="o">=</span> <span class="s">"contents"</span>
<span class="c1">#useful_classes = ["python","rè¯­è¨€","spss","excel","ppt","word","sql","sas","vba","office","msoffice",
#                  "hadoop","spark","hive","scala","hbase","java","matlab","linux","shell","c#"]
#                  "æœºå™¨å­¦ä¹ ","æ•°æ®æŒ–æ˜","æ•°å­¦å»ºæ¨¡","è‡ªç„¶è¯­è¨€å¤„ç†","è‡ªç„¶è¯­è¨€","æ–‡æœ¬æŒ–æ˜",
</span><span class="n">useful_classes</span> <span class="o">=</span> <span class="p">[</span><span class="s">'excel'</span><span class="p">,</span> <span class="s">'sql'</span><span class="p">,</span> <span class="s">'python'</span><span class="p">,</span> <span class="s">'sas'</span><span class="p">,</span> <span class="s">'spss'</span><span class="p">,</span><span class="s">'hadoop'</span><span class="p">,</span> <span class="s">'spark'</span><span class="p">,</span> <span class="s">'hive'</span><span class="p">,</span> <span class="s">'shell'</span><span class="p">,</span> <span class="s">'java'</span><span class="p">]</span>                  
<span class="n">dum</span> <span class="o">=</span> <span class="n">get_imp_info</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">useful_classes</span><span class="p">,</span><span class="s">"skill"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">dum</span><span class="p">)</span>
<span class="c1"># æŠ€èƒ½è¦æ±‚å‰10ï¼šexcel sql python sas spss | hadoop spark hive shell java 
</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">,</span><span class="n">dum</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1">#æŠ€èƒ½ä¸å¹³å‡è–ªèµ„
</span><span class="k">def</span> <span class="nf">mean_salary</span><span class="p">(</span><span class="n">useful_classes</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">salary</span><span class="p">,</span><span class="n">prefix</span><span class="p">):</span>
    <span class="n">feature_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">prefix</span><span class="o">+</span><span class="s">"_"</span><span class="o">+</span><span class="n">skill</span> <span class="k">for</span> <span class="n">skill</span> <span class="ow">in</span> <span class="n">useful_classes</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_list</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"skill"</span><span class="p">,</span><span class="s">"mean_salary"</span><span class="p">,</span><span class="s">"count"</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s">"skill"</span><span class="p">]</span> <span class="o">=</span> <span class="n">useful_classes</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">df</span><span class="p">[</span><span class="s">"mean_salary"</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s">"skill"</span><span class="p">]</span><span class="o">==</span><span class="n">useful_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">salary</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="n">feature_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">==</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s">"count"</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s">"skill"</span><span class="p">]</span><span class="o">==</span><span class="n">useful_classes</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">salary</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="n">feature_list</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">==</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">useful_classes</span> <span class="o">=</span> <span class="p">[</span><span class="s">'excel'</span><span class="p">,</span> <span class="s">'sql'</span><span class="p">,</span> <span class="s">'python'</span><span class="p">,</span> <span class="s">'sas'</span><span class="p">,</span> <span class="s">'spss'</span><span class="p">,</span><span class="s">'hadoop'</span><span class="p">,</span> <span class="s">'spark'</span><span class="p">,</span> <span class="s">'hive'</span><span class="p">,</span> <span class="s">'shell'</span><span class="p">,</span> <span class="s">'java'</span><span class="p">]</span>                  
<span class="n">salary</span> <span class="o">=</span> <span class="s">"average_wage"</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="s">"skill"</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">mean_salary</span><span class="p">(</span><span class="n">useful_classes</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">salary</span><span class="p">,</span><span class="n">prefix</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">'ggplot'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> 
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">"skill"</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">"mean_salary"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"skill_software"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"mean_salary"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">"skill_salary.jpg"</span><span class="p">)</span>

<span class="c1"># å…¬å¸
</span><span class="n">data</span><span class="p">[</span><span class="s">"compname"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>


<span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'compname'</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#data = pd.get_dummies(data)
</span>
<span class="c1">#data.to_csv("data_analysis.csv",index = False,encoding = "gbk")
</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">"average_wage"</span><span class="p">,</span><span class="s">'contents'</span><span class="p">,</span><span class="s">'kmeans'</span><span class="p">,</span><span class="s">'gmm'</span><span class="p">,</span><span class="s">'nmf'</span><span class="p">,</span><span class="s">"skill_text"</span><span class="p">,</span><span class="s">"index"</span><span class="p">,</span><span class="s">"compname"</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">);</span><span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"average_wage"</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">regr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="c1">#è¾“å‡ºRçš„å¹³æ–¹
</span><span class="k">print</span><span class="p">(</span><span class="n">regr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">))</span>
<span class="n">regr</span><span class="o">.</span><span class="n">coef_</span>
</code></pre></div></div>

<p><img src="/assets/images/post_images/regression.png" /></p>

<p>ä»è¡¨3å›å½’ç³»æ•°è¡¨å¯ä»¥çœ‹å‡ºï¼ŒæŠ€èƒ½åˆ†æ•°å¯¹å®ä¹ å·¥èµ„æœ‰æ˜¾è‘—å½±å“ï¼Œå®ä¹ åˆ†æ•°æ¯å¤šä¸€åˆ†ï¼Œå³å¤šæŒæ¡ä¸€é—¨å¸¸ç”¨ç»Ÿè®¡è½¯ä»¶ç”šè‡³å¤šæŒæ¡ä¸€é—¨å¤§æ•°æ®åˆ†æç›¸å…³è½¯ä»¶ï¼Œåˆ™å¹³å‡å®ä¹ å·¥èµ„æ¶¨çº¦7å…ƒã€‚å› ä¸ºä»…ä»…æ˜¯å®ä¹ è€Œä¸æ˜¯æ­£å¼å‘˜å·¥ï¼Œä¸åŒçš„å®ä¹ ï¼Œæ—¥å®ä¹ å·¥èµ„å‡ ä¹åªåœ¨100-200å†…æµ®åŠ¨ï¼Œå› æ­¤æŠ€èƒ½å¯¹å·¥èµ„ä¸Šæ¶¨å½±å“ä¸å¤ªå¤§ã€‚</p>

<p>å…¶ä»–æ–¹é¢ï¼Œä»å®ä¹ æ—¶é—´ä¸Šçœ‹ï¼Œè¦æ±‚ä¸€å‘¨å®ä¹ å¤©æ•°è¶Šå¤šï¼Œè¯´æ˜å…¬å¸è¶Šéœ€äººæ•°ï¼Œæ„¿æ„å¼€å‡ºçš„å®ä¹ å·¥èµ„è¶Šé«˜ï¼›ä»å­¦å†è¦æ±‚ä¸Šçœ‹ï¼Œè¦æ±‚å­¦å†æ˜¯æœ¬ç§‘ç”Ÿçš„å®ä¹ å·¥èµ„æ¯”ä¸é™ä¸“ä¸šçš„å·¥èµ„ä½12.59å…ƒï¼›ä»ä¸“ä¸šè¦æ±‚ä¸Šçœ‹ï¼Œè¦æ±‚ä¸“ä¸šæ˜¯è®¡ç®—æœºçš„å®ä¹ å·¥èµ„æ¯”ä¸“ä¸šè¦æ±‚ä¸ºå…¶ä»–çš„å®ä¹ å·¥èµ„é«˜16.44ï¼Œè®¡ç®—æœºä¸“ä¸šå‡ºèº«çš„å­¦ç”Ÿä»æ˜¯å°±ä¸šå¸‚åœºä¸­çš„çƒ­ç‚¹éœ€æ±‚ï¼›ä»å®ä¹ åœ°ç‚¹ä¸Šçœ‹ï¼ŒåŒ—ä¸Šå¹¿æ·±æ­çš„å®ä¹ å·¥èµ„æ¯”å…¶ä»–åŸå¸‚å¤š20å…ƒä»¥ä¸Šï¼Œå…¶ä¸­æ­å·çš„å®ä¹ æ¯”å…¶ä»–åŸå¸‚çš„å®ä¹ é«˜37å…ƒï¼Œè€Œæˆéƒ½ã€æ­¦æ±‰åˆ™æ¯”å…¶ä»–åŸå¸‚å°‘5å…ƒä»¥ä¸Šï¼›ä»å…¬å¸è¡Œä¸šä¸Šçœ‹ï¼Œäº’è”ç½‘ã€è®¡ç®—æœºè¡Œä¸šçš„å…¬å¸æ›´ä¸ºå¤§æ–¹äº›ï¼Œå¼€å‡ºçš„å®ä¹ å·¥èµ„æ›´é«˜ï¼›ä»å…¬å¸è§„æ¨¡ä¸Šçœ‹ï¼Œä¸­å‹ä¼ä¸šæ¯”å°å‹ä¼ä¸šå¼€å‡ºçš„å®ä¹ å·¥èµ„å°‘10å…ƒï¼Œè€Œå¤§å‹ä¼ä¸šåˆ™æ¯”å°å‹ä¼ä¸šå¤š3å…ƒï¼Œå·¥èµ„æ¡ä»¶ä»æ˜¯å¤§å…¬å¸å¸å¼•å°±ä¸šè€…çš„ä¼˜åŠ¿ã€‚</p>

<p>åœ¨è¯¥å›å½’æ–¹ç¨‹ä¸­ï¼ŒFæ£€éªŒæ˜¾è‘—ï¼ŒRæ–¹ä»…ä¸º0.6ï¼Œè¯´æ˜è‡ªå˜é‡å¯¹å®ä¹ å·¥èµ„çš„æ³¢åŠ¨ä»…è§£é‡Šäº†60%ï¼Œå¦å¤–å®ä¹ å·¥èµ„è¿˜è·Ÿå…·ä½“å…¬å¸è§„å®šï¼Œå¸‚åœºè¡Œæƒ…æœ‰å…³ã€‚</p>

<h2 id="ç»“è®º">ç»“è®º</h2>
<p>æœ¬æ–‡é€šè¿‡çˆ¬å–å®ä¹ åƒ§ç½‘ç«™â€œæ•°æ®åˆ†æâ€ä¸€èŒçš„å®ä¹ ä¿¡æ¯ï¼Œå¯¹â€œèŒä½æè¿°â€çš„æ–‡æœ¬è¿›è¡Œé¢„å¤„ç†ã€åˆ†å¥ï¼Œä½¿ç”¨LDAæå–å…¶ä¸­åŒ…å«æŠ€èƒ½ä¸»é¢˜çš„å¥å­ï¼Œå¹¶å¯¹è¿™äº›å¥å­å†æ¬¡æå–æŠ€èƒ½ä¸»é¢˜ï¼ŒåŒºåˆ†ä¸åŒå±‚æ¬¡çš„æŠ€èƒ½è¦æ±‚ï¼Œå¹¶å¯¹èŒä½çš„æŠ€èƒ½è¦æ±‚è¿›è¡Œæ‰“åˆ†ï¼Œä»è€Œå®ç°å²—ä½ä¿¡æ¯ä¸­æŠ€èƒ½è¦æ±‚çš„é‡åŒ–ï¼Œä½¿å¾—æŠ€èƒ½ä¸è–ªé…¬çš„å…³ç³»èƒ½æ›´æ·±å…¥åœ°åˆ†æã€‚é€šè¿‡ä»¥ä¸Šåˆ†æï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹ä¸‰ä¸ªç»“è®ºï¼š</p>

<p>ç¬¬ä¸€ï¼Œ	æ•°æ®åˆ†æå¸ˆéœ€æ±‚é¢‘ç‡æ’åœ¨å‰åˆ—çš„æŠ€èƒ½æœ‰ï¼šSQLï¼ŒExcel, SASï¼ŒSPSS, Python, Hadoopå’ŒMySQLç­‰ï¼Œå…¶ä¸­SQLå’ŒExcelç®€ç›´å¯ä»¥è¯´æ˜¯å¿…å¤‡æŠ€èƒ½ï¼›</p>

<p>ç¬¬äºŒï¼Œ	æµ·é‡æ•°æ®ã€åˆ†å¸ƒå¼å¤„ç†æ¡†æ¶æ˜¯èµ°å‘é«˜è–ªçš„æ­£ç¡®æ–¹å‘ï¼›</p>

<p>ç¬¬ä¸‰ï¼Œ	SQLè¯­è¨€å’Œä¼ ç»Ÿçš„SASï¼ŒSPSSä¸¤å¤§æ•°æ®åˆ†æè½¯ä»¶ï¼Œèƒ½å¤Ÿè®©ä½ åœ¨ä¿è¯ä¸­ç­‰æ”¶å…¥çš„æ¡ä»¶ä¸‹ï¼Œèƒ½å¤Ÿé€‚åº”æ›´å¤šä¼ä¸šçš„è¦æ±‚ï¼Œä¹Ÿå°±æ„å‘³ç€æ›´å¤šçš„å·¥ä½œæœºä¼šã€‚</p>

<p>æœ¬æ–‡ä»…ä»¥å®ä¹ åƒ§ç½‘ç«™çš„æ•°æ®åˆ†æå®ä¹ å²—ä¸ºä¾‹ï¼Œé˜è¿°å¦‚ä½•é€šè¿‡LDAæå–å¹¶é‡åŒ–èŒä½æè¿°ä¸­çš„ä¸“ä¸šæŠ€èƒ½è¦æ±‚ï¼Œå› æ­¤æ•°æ®é‡æ¯”è¾ƒå°ï¼Œä»£è¡¨æ€§ä¸å¤Ÿå¥½ï¼Œå¦å¤–ç»“æœé€‚åˆäºå®ä¹ æ–¹é¢çš„æ•°æ®åˆ†æå²—è€Œä¸æ˜¯æ­£å¼å·¥ä½œã€‚å¦å¤–æœ¬æ¬¡åˆ†æä¸»è¦é’ˆå¯¹å·¥å…·å‹çš„æŠ€èƒ½è¿›è¡Œäº†åˆ†æã€‚ä½†å®é™…ä¸Šæ•°æ®åˆ†æå¸ˆæ‰€éœ€è¦å…·å¤‡çš„ç´ è´¨è¿œä¸æ­¢è¿™äº›ï¼Œè¿˜éœ€è¦æœ‰æ‰å®çš„æ•°å­¦ã€ç»Ÿè®¡å­¦åŸºç¡€ï¼Œè‰¯å¥½çš„æ•°æ®æ•æ„Ÿåº¦ï¼Œå¼€æ‹“ä½†ä¸¥è°¨çš„æ€ç»´ç­‰ã€‚</p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>æ•£ç‚¹å›¾å‚è€ƒï¼š</p>
<ul>
  <li><a href="https://zhuanlan.zhihu.com/p/25704059">æ•°æ®åˆ†æå¸ˆæŒ£å¤šå°‘é’±ï¼Ÿâ€œé»‘â€äº†æ‹›è˜ç½‘ç«™å‘Šè¯‰ä½ ï¼</a></li>
</ul>

<p><span id="busuanzi_container_page_pv">
  æœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡
</span></p>
:ET